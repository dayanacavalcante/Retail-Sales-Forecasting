# Retail Sales Forecasting

Monthly Sales forecast using the LSTM (Long Short-term Memory) method.

## *Data*

The dataset has 937 rows x 4 columns with date, sale, stock and price columns. It was extracted from a Brazilian top retailer. The data was transformed to protect the identity of the retailer. Data refer to the years 2014, 2015 and 2016.

The data was taken from Kaggle: https://www.kaggle.com/tevecsystems/retail-sales-forecasting

```
Data columns (total 4 columns):
 #   Column   Non-Null Count  Dtype
---  ------   --------------  -----
 0   data     937 non-null    object
 1   venda    937 non-null    int64
 2   estoque  937 non-null    int64
 3   preco    937 non-null    float64
dtypes: float64(1), int64(2), object(1)
```

Grouped dates monthly and added sales:

```
        data  venda
0  2014-01-01   3985
1  2014-02-01   2018
2  2014-03-01   2137
3  2014-04-01   1990
4  2014-05-01   2493
5  2014-06-01   2629
6  2014-07-01   1131
7  2014-08-01   1452
8  2014-09-01   2185
9  2014-10-01   2765
10 2014-11-01   1462
11 2014-12-01   1010
12 2015-01-01   2465
13 2015-02-01   1918
14 2015-03-01   3379
15 2015-04-01   2123
16 2015-05-01    647
17 2015-06-01   2880
18 2015-07-01   3104
19 2015-08-01   1826
20 2015-09-01   2790
21 2015-10-01   3974
22 2015-11-01   3214
23 2015-12-01   3914
24 2016-01-01   2365
25 2016-02-01   2832
26 2016-03-01   2206
27 2016-04-01   4028
28 2016-05-01   4407
29 2016-06-01   6347
30 2016-07-01   5154
```

## *Data Transformation*

* Conversion of data to stationary, if it not is;
* Conversion from time series to supervised to have the feature set of our LSTM model;
* Scale the data;

Data with calculated difference:
```
         data  venda  prev_sales    diff
1  2014-02-01   2018      3985.0 -1967.0
2  2014-03-01   2137      2018.0   119.0
3  2014-04-01   1990      2137.0  -147.0
4  2014-05-01   2493      1990.0   503.0
5  2014-06-01   2629      2493.0   136.0
6  2014-07-01   1131      2629.0 -1498.0
7  2014-08-01   1452      1131.0   321.0
8  2014-09-01   2185      1452.0   733.0
9  2014-10-01   2765      2185.0   580.0
10 2014-11-01   1462      2765.0 -1303.0
11 2014-12-01   1010      1462.0  -452.0
12 2015-01-01   2465      1010.0  1455.0
13 2015-02-01   1918      2465.0  -547.0
14 2015-03-01   3379      1918.0  1461.0
15 2015-04-01   2123      3379.0 -1256.0
16 2015-05-01    647      2123.0 -1476.0
17 2015-06-01   2880       647.0  2233.0
18 2015-07-01   3104      2880.0   224.0
19 2015-08-01   1826      3104.0 -1278.0
20 2015-09-01   2790      1826.0   964.0
21 2015-10-01   3974      2790.0  1184.0
22 2015-11-01   3214      3974.0  -760.0
23 2015-12-01   3914      3214.0   700.0
24 2016-01-01   2365      3914.0 -1549.0
25 2016-02-01   2832      2365.0   467.0
26 2016-03-01   2206      2832.0  -626.0
27 2016-04-01   4028      2206.0  1822.0
28 2016-05-01   4407      4028.0   379.0
29 2016-06-01   6347      4407.0  1940.0
30 2016-07-01   5154      6347.0 -1193.0
```

With the stationary data I can start building the feature set. You must use past monthly sales data to forecast upcoming ones. The lookback period may vary for each model. For this case it was 12.

I created columns from lag_1 to lag_12 and assigned values using the shift() method:
```
         data  venda    diff   lag_1   lag_2   lag_3   lag_4  ...   lag_6   lag_7   lag_8   lag_9  lag_10  lag_11  lag_12
0  2015-02-01   1918  -547.0  1455.0  -452.0 -1303.0   580.0  ...   321.0 -1498.0   136.0   503.0  -147.0   119.0 -1967.0
1  2015-03-01   3379  1461.0  -547.0  1455.0  -452.0 -1303.0  ...   733.0   321.0 -1498.0   136.0   503.0  -147.0   119.0
2  2015-04-01   2123 -1256.0  1461.0  -547.0  1455.0  -452.0  ...   580.0   733.0   321.0 -1498.0   136.0   503.0  -147.0
3  2015-05-01    647 -1476.0 -1256.0  1461.0  -547.0  1455.0  ... -1303.0   580.0   733.0   321.0 -1498.0   136.0   503.0
4  2015-06-01   2880  2233.0 -1476.0 -1256.0  1461.0  -547.0  ...  -452.0 -1303.0   580.0   733.0   321.0 -1498.0   136.0
5  2015-07-01   3104   224.0  2233.0 -1476.0 -1256.0  1461.0  ...  1455.0  -452.0 -1303.0   580.0   733.0   321.0 -1498.0
6  2015-08-01   1826 -1278.0   224.0  2233.0 -1476.0 -1256.0  ...  -547.0  1455.0  -452.0 -1303.0   580.0   733.0   321.0
7  2015-09-01   2790   964.0 -1278.0   224.0  2233.0 -1476.0  ...  1461.0  -547.0  1455.0  -452.0 -1303.0   580.0   733.0
8  2015-10-01   3974  1184.0   964.0 -1278.0   224.0  2233.0  ... -1256.0  1461.0  -547.0  1455.0  -452.0 -1303.0   580.0
9  2015-11-01   3214  -760.0  1184.0   964.0 -1278.0   224.0  ... -1476.0 -1256.0  1461.0  -547.0  1455.0  -452.0 -1303.0
10 2015-12-01   3914   700.0  -760.0  1184.0   964.0 -1278.0  ...  2233.0 -1476.0 -1256.0  1461.0  -547.0  1455.0  -452.0
11 2016-01-01   2365 -1549.0   700.0  -760.0  1184.0   964.0  ...   224.0  2233.0 -1476.0 -1256.0  1461.0  -547.0  1455.0
12 2016-02-01   2832   467.0 -1549.0   700.0  -760.0  1184.0  ... -1278.0   224.0  2233.0 -1476.0 -1256.0  1461.0  -547.0
13 2016-03-01   2206  -626.0   467.0 -1549.0   700.0  -760.0  ...   964.0 -1278.0   224.0  2233.0 -1476.0 -1256.0  1461.0
14 2016-04-01   4028  1822.0  -626.0   467.0 -1549.0   700.0  ...  1184.0   964.0 -1278.0   224.0  2233.0 -1476.0 -1256.0
15 2016-05-01   4407   379.0  1822.0  -626.0   467.0 -1549.0  ...  -760.0  1184.0   964.0 -1278.0   224.0  2233.0 -1476.0
16 2016-06-01   6347  1940.0   379.0  1822.0  -626.0   467.0  ...   700.0  -760.0  1184.0   964.0 -1278.0   224.0  2233.0
17 2016-07-01   5154 -1193.0  1940.0   379.0  1822.0  -626.0  ... -1549.0   700.0  -760.0  1184.0   964.0 -1278.0   224.0

[18 rows x 15 columns]
```




